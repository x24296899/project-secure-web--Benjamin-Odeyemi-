<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Home â€” Secure Web</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <header>
      <h1>My Secure Web App</h1>
      <nav>
        <a href="index.html">Home</a>
      </nav>
    </header>
    <main>
      <h2>Home</h2>
      <p id="welcome"></p>
      <div id="links"></div>
      <button id="logout">Logout</button>
    </main>
    <script type="module">
      import { getSession, clearSession, getUser } from './users.js';

      const welcome = document.getElementById('welcome');
      const links = document.getElementById('links');
      const logout = document.getElementById('logout');

      (async function init() {
        const email = getSession();
        if (!email) {
          location.href = 'login.html';
          return;
        }
        const user = await getUser(email);
        welcome.textContent = `Welcome, ${email} (${user.role || 'user'})`;
        links.textContent = '';
        if (user.role === 'admin') {
          const p = document.createElement('p'); const a = document.createElement('a'); a.href = 'admin.html'; a.textContent = 'Go to Admin Panel'; p.appendChild(a); links.appendChild(p);
        }
        const p2 = document.createElement('p'); const a2 = document.createElement('a'); a2.href = 'dashboard.html'; a2.textContent = 'Go to Dashboard'; p2.appendChild(a2); links.appendChild(p2);
      })();

      logout.addEventListener('click', () => {
        clearSession();
        location.href = 'index.html';
      });
    </script>
  </body>
</html>
